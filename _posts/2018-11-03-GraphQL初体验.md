---
layout: post
title: GraphQL初体验
---
公司小组内有技术分享，快轮到我了，思来想去很多主题都讲过了，觉得GraphQL的口碑还不错，所以决定分享GraphQL，体验一下。刚开始看到有点转不过弯来，毕竟平常开发都是 RESTFul 的，对GraphQL的理念有点不适应，一个接口走天下的模式有点不理解。我们平常开发REST式的，对每个业务定义一个API，每个API的 GET POST DELETE method对应业务的查询修改和删除。

GraphQL虽然只是一种规范，但是它也有自己的语法，“GraphQL Schema Language”，定义了前后端的参数传递。
GraphQL的参数类型如下
~~~
Int: 有符号的32位整型
Float: 有符号的双精度浮点型
String: UTF‐8字符序列
Boolean: 布尔型
ID: 常用于获取数据的唯一标志，或缓存的键值，它也会被序列化为String，但可读性差。
枚举(Enum)
对象(Ojbect)
集合(List)
非空/Null(Non-Null)
~~~

GraphQL的操作类型如下

~~~
Query
Mutation
~~~

如果没有定义操作类型，那么就默认为查询操作。当命令传递到后端时，Query上的参数是并行的，而Mutation是串行的。

如果前端没有对GraphQL封装，我们可以直接发送fetch请求。

~~~
fetch('http://localhost:4000/graphql', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'Accept': 'application/json',
    },
    body: JSON.stringify({query: '{ hello }', variables: {name: 'bob'}})
})
    .then(r => r.json())
    .then(data => console.log('data returned:', data));
~~~

平常项目多用vue，也可以安装vue-apollo，vue-apollo整合了vue和graphql.js，将graphql请求语法封装进 this.$apollo 中。

~~~
// 安装，如果有vue项目，直接安装；没有，先安装 vue-cli 再安装
npm install --save vue-apollo graphql apollo-client apollo-link apollo-link-http apollo-cache-inmemory graphql-tag
~~~
