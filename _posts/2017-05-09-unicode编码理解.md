---
layout: post
title: unicode编码理解
---

在使用webpack的过程中，发现一项图片转化的技术--Data URL，即可以将比较小的图片直接以base64编码的形式嵌入html文件中，而不需要额外去服务器请求img。

### Data URL原理
我们平常使用图片时，一般写法如下
~~~
<img src="/Public/lanqb_copartnerv1/image/copartner/images/No2.png"/>
~~~

这样页面加载的时候会去服务器请求No2.png，然后显示在页面上。有的页面要加载的图片可能有几十个，这样在加载页面的时候，加载时间就大大增加了，因为每次请求图片都需要发送一个http请求，这么多的请求既影响页面性能，也会影响服务器性能。这时候有一种机智的方法，通过Data URL方法，可以将图片直接写在html文件中

~~~
<img src="data:image/png;base64,R0lGODlhMwAxAIAAAAAAAP///
yH5BAAAAAAALAAAAAAzADEAAAK8jI+pBr0PowytzotTtbm/DTqQ6C3hGX
ElcraA9jIr66ozVpM3nseUvYP1UEHF0FUUHkNJxhLZfEJNvol06tzwrgd
LbXsFZYmSMPnHLB+zNJFbq15+SOf50+6rG7lKOjwV1ibGdhHYRVYVJ9Wn
k2HWtLdIWMSH9lfyODZoZTb4xdnpxQSEF9oyOWIqp6gaI9pI1Qo7BijbF
ZkoaAtEeiiLeKn72xM7vMZofJy8zJys2UxsCT3kO229LH1tXAAAOw==">
~~~

这样，可以节省一次http请求。虽然这种写写法能够有效减少http请求次数，但是，这样也会造成图片经过base64编码后，文件比原始图片大三分之一的内存。我们知道，文件都是按照一定编码的二进制数据。那我就在想，为何要用base64编码使字符串增长呢，直接用图片原来的编码写在html文件中不行吗。后来查询了资料，不仅明白了也了解了文字编码utf-8的原因。
不同的扩展名文件便于编译系统用不同的应用程序去运行，应用程序根据这些文件的文件头来决定如何处理。比如我的头像是一张png图片，用十六进制打开后，可以获得

![png-head](/img/png_head.png)

我们可以查询获得png文件的文件头

|十六进制|89 50 4E 47 0D 0A 1A 0A|
|十进制|137 80 78 71 13 10 26 10|

一般文件头包含着文件的描述信息，比如图片文件头一般包含图片的宽和高。但不是所有文件都有文件头，比如txt文件，我们打开的时候，只有根据编码形式的区别。
在一个txt文件中输入以下文字，并以UTF-8编码保存。

~~~
这是一个测试文件
~~~

当我们用十六进制形式打开时，可以看到

![utf-8](/img/utf-8.png)

再以UTF-16编码保存。当我们用十六进制形式打开时，可以看到

![utf-16](/img/utf-16.png)

可以看到他们的BOM头部是不同的

|UTF-8|EF BB BF|
|UTF-16|FF FE |

